{"version":3,"file":"ng2-canvas-whiteboard.mjs","sources":["../../../projects/ng2-canvas-whiteboard/src/lib/canvas-whiteboard-update.model.ts","../../../projects/ng2-canvas-whiteboard/src/lib/template.ts","../../../projects/ng2-canvas-whiteboard/src/lib/canvas-whiteboard-point.model.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/canvas-whiteboard-shape-options.ts","../../../projects/ng2-canvas-whiteboard/src/lib/canvas-whiteboard.service.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/canvas-whiteboard-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/circle-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/rectangle-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/free-hand-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/smiley-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/star-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/line-shape.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/canvas-whiteboard-shape.service.ts","../../../projects/ng2-canvas-whiteboard/src/lib/canvas-whiteboard-colorpicker.component.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/canvas-whiteboard-shape-preview.component.ts","../../../projects/ng2-canvas-whiteboard/src/lib/shapes/canvas-whiteboard-shape-selector.component.ts","../../../projects/ng2-canvas-whiteboard/src/lib/canvas-whiteboard.component.ts","../../../projects/ng2-canvas-whiteboard/src/lib/ng2-canvas-whiteboard.module.ts","../../../projects/ng2-canvas-whiteboard/src/public-api.ts","../../../projects/ng2-canvas-whiteboard/src/ng2-canvas-whiteboard.ts"],"sourcesContent":["import {CanvasWhiteboardShapeOptions} from \"./shapes/canvas-whiteboard-shape-options\";\n\nexport enum CanvasWhiteboardUpdateType {\n  START = 0,\n  DRAG = 1,\n  STOP = 2\n}\n\nexport class CanvasWhiteboardUpdate {\n  x: number;\n  y: number;\n  type: CanvasWhiteboardUpdateType;\n  UUID: string;\n\n  selectedShape: string;\n  selectedShapeOptions: CanvasWhiteboardShapeOptions;\n\n  static deserializeJson(json: any): CanvasWhiteboardUpdate {\n    let parsedJson;\n    try {\n      parsedJson = JSON.parse(json);\n      return new CanvasWhiteboardUpdate(\n        parsedJson['x'],\n        parsedJson['y'],\n        parsedJson['type'],\n        parsedJson['uuid'],\n        parsedJson['selectedShape'],\n        parsedJson['selectedShapeOptions']);\n    } catch (e) {\n      console.error(\"The canvas whiteboard update is not parseable\");\n      return null;\n    }\n  }\n\n  constructor(x?: number,\n              y?: number,\n              type?: CanvasWhiteboardUpdateType,\n              UUID?: string,\n              selectedShape?: string,\n              selectedShapeOptions?: CanvasWhiteboardShapeOptions) {\n    this.x = x;\n    this.y = y;\n    this.type = type;\n    this.UUID = UUID;\n    this.selectedShape = selectedShape;\n    this.selectedShapeOptions = selectedShapeOptions;\n  }\n\n  stringify(): string {\n    const objectToSerialize = {\n      x: this.x.toFixed(3),\n      y: this.y.toFixed(3),\n      type: this.type,\n      uuid: this.UUID,\n      selectedShape: this.selectedShape\n    };\n\n    if (this.selectedShapeOptions) {\n      objectToSerialize['selectedShapeOptions'] = this.selectedShapeOptions;\n    }\n\n    return JSON.stringify(objectToSerialize);\n  }\n}\n","export const DEFAULT_STYLES = `\n.canvas_whiteboard_button {\n    display: inline-block;\n    outline: 0px;\n    padding-top: 7px;\n    margin-bottom: 0;\n    font-size: 14px;\n    font-weight: 400;\n    line-height: 1.42857143;\n    text-align: center;\n    white-space: nowrap;\n    vertical-align: middle;\n    -ms-touch-action: manipulation;\n    touch-action: manipulation;\n    cursor: pointer;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    background-image: none;\n    border: 1px solid transparent;\n    border-radius: 4px;\n}\n\n.canvas_whiteboard_buttons {\n    z-index: 3;\n}\n\n@media (max-width: 400px) {\n     .canvas_whiteboard_buttons {\n            position: absolute;\n            top: 0;\n            width: 100%;\n            text-align: center;\n      }\n}\n\n@media (min-width: 401px) {\n    .canvas_whiteboard_buttons {\n        position: absolute;\n        right: 0%;\n        color: #fff;\n    }\n}\n\n.canvas_whiteboard_buttons {\n    padding: 5px;\n}\n\n.canvas_whiteboard_buttons > button {\n    margin: 5px;\n}\n\n.canvas_whiteboard_button-draw_animated {\n    -webkit-animation: pulsate 1s ease-out;\n    -webkit-animation-iteration-count: infinite;\n}\n\n@keyframes pulsate {\n    0% {\n        -webkit-transform: scale(0.1, 0.1);\n        opacity: 0.0;\n    }\n    50% {\n        opacity: 1.0;\n    }\n    100% {\n        -webkit-transform: scale(1.2, 1.2);\n        opacity: 0.0;\n    }\n}\n.canvas_wrapper_div {\n    width: 100%;\n    height: 100%;\n    border: 0.5px solid #e2e2e2;\n}\n\n.canvas_whiteboard_button-clear {\n    padding-top: 5px;\n}\n\n.canvas_whiteboard {\n    position: absolute;\n    z-index: 1;\n}\n\n.incomplete_shapes_canvas_whiteboard {\n    position: absolute;\n    z-index: 2;\n}\n\n`;\n","export class CanvasWhiteboardPoint {\n  x: number;\n  y: number;\n\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n}\n","export class CanvasWhiteboardShapeOptions {\n  shouldFillShape?: boolean;\n  fillStyle?: string;\n  strokeStyle?: string;\n  lineWidth?: number;\n  lineJoin?: string;\n  lineCap?: string;\n\n  constructor() {\n    this.shouldFillShape = false;\n    this.fillStyle = null;\n    this.strokeStyle = 'rgba(0, 0, 0, 1)';\n    this.lineWidth = 2;\n    this.lineJoin = 'round';\n    this.lineCap = 'round';\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanvasWhiteboardUpdate } from './canvas-whiteboard-update.model';\nimport { Observable, Subject } from 'rxjs';\n\n@Injectable()\nexport class CanvasWhiteboardService {\n  private _canvasDrawSubject: Subject<CanvasWhiteboardUpdate[]> = new Subject();\n  canvasDrawSubject$: Observable<CanvasWhiteboardUpdate[]> = this._canvasDrawSubject.asObservable();\n\n  private _canvasClearSubject: Subject<any> = new Subject();\n  canvasClearSubject$: Observable<any> = this._canvasClearSubject.asObservable();\n\n  private _canvasUndoSubject: Subject<any> = new Subject();\n  canvasUndoSubject$: Observable<any> = this._canvasUndoSubject.asObservable();\n\n  private _canvasRedoSubject: Subject<any> = new Subject();\n  canvasRedoSubject$: Observable<any> = this._canvasRedoSubject.asObservable();\n\n  public drawCanvas(updates: CanvasWhiteboardUpdate[]): void {\n    this._canvasDrawSubject.next(updates);\n  }\n\n  public clearCanvas(): void {\n    this._canvasClearSubject.next();\n  }\n\n  public undoCanvas(updateUUD: string): void {\n    this._canvasUndoSubject.next(updateUUD);\n  }\n\n  public redoCanvas(updateUUD: string): void {\n    this._canvasRedoSubject.next(updateUUD);\n  }\n}\n","import { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport abstract class CanvasWhiteboardShape {\n  isVisible: boolean;\n  protected positionPoint: CanvasWhiteboardPoint;\n  protected options: CanvasWhiteboardShapeOptions;\n\n  protected constructor(positionPoint?: CanvasWhiteboardPoint,\n                        options?: CanvasWhiteboardShapeOptions) {\n    this.positionPoint = positionPoint || new CanvasWhiteboardPoint(0, 0);\n    this.options = options || new CanvasWhiteboardShapeOptions();\n    this.isVisible = true;\n  }\n\n  abstract getShapeName(): string;\n\n  abstract onUpdateReceived(update: CanvasWhiteboardUpdate): void;\n\n  // noinspection TsLint\n  onStopReceived(update: CanvasWhiteboardUpdate): void {\n  }\n\n  abstract draw(context: CanvasRenderingContext2D): void;\n\n  abstract drawPreview(context: CanvasRenderingContext2D): void;\n}\n","import { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport class CircleShape extends CanvasWhiteboardShape {\n  radius: number;\n\n  constructor(positionPoint?: CanvasWhiteboardPoint, options?: CanvasWhiteboardShapeOptions, radius?: number) {\n    super(positionPoint, options);\n    this.radius = radius || 0;\n  }\n\n  getShapeName(): string {\n    return 'CircleShape';\n  }\n\n  draw(context: CanvasRenderingContext2D): void {\n    context.beginPath();\n    context.arc(this.positionPoint.x, this.positionPoint.y, this.radius, 0, Math.PI * 2, false);\n\n    Object.assign(context, this.options);\n\n    context.stroke();\n    if (this.options.shouldFillShape) {\n      context.fill();\n    }\n\n    context.closePath();\n  }\n\n  drawPreview(context: CanvasRenderingContext2D): void {\n    this.positionPoint = new CanvasWhiteboardPoint(context.canvas.width / 2, context.canvas.height / 2);\n    this.radius = this.calculateRadius(context.canvas.width - 2, context.canvas.height / 2);\n    this.draw(context);\n  }\n\n  onUpdateReceived(update: CanvasWhiteboardUpdate): void {\n    this.radius = this.calculateRadius(update.x, update.y);\n  }\n\n  calculateRadius(x: number, y: number): number {\n    return Math.sqrt(Math.pow(x - this.positionPoint.x, 2) + Math.pow(y - this.positionPoint.y, 2));\n  }\n}\n","import { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport class RectangleShape extends CanvasWhiteboardShape {\n  width: number;\n  height: number;\n\n  constructor(positionPoint?: CanvasWhiteboardPoint,\n              options?: CanvasWhiteboardShapeOptions,\n              width?: number,\n              height?: number) {\n    super(positionPoint, options);\n    this.width = width || 0;\n    this.height = height || 0;\n  }\n\n  getShapeName(): string {\n    return 'RectangleShape';\n  }\n\n  draw(context: CanvasRenderingContext2D): void {\n    if (!this.width || !this.height) {\n      return;\n    }\n    context.beginPath();\n\n    Object.assign(context, this.options);\n\n    context.rect(this.positionPoint.x, this.positionPoint.y, this.width, this.height);\n\n    context.stroke();\n    if (this.options.shouldFillShape) {\n      context.fill();\n    }\n\n    context.closePath();\n  }\n\n  drawPreview(context: CanvasRenderingContext2D): void {\n    this.positionPoint = new CanvasWhiteboardPoint(2, 2);\n    this.width = context.canvas.width - 4;\n    this.height = context.canvas.height - 4;\n    this.draw(context);\n  }\n\n  onUpdateReceived(update: CanvasWhiteboardUpdate): void {\n    this.width = update.x - this.positionPoint.x;\n    this.height = update.y - this.positionPoint.y;\n  }\n}\n","import { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport class FreeHandShape extends CanvasWhiteboardShape {\n  linePositions: CanvasWhiteboardPoint[];\n\n  constructor(positionPoint?: CanvasWhiteboardPoint, options?: CanvasWhiteboardShapeOptions) {\n    super(positionPoint, options);\n    this.linePositions = [];\n  }\n\n  getShapeName(): string {\n    return 'FreeHandShape';\n  }\n\n  draw(context: CanvasRenderingContext2D): void {\n    Object.assign(context, this.options);\n\n    context.beginPath();\n    context.moveTo(this.positionPoint.x, this.positionPoint.y);\n    // Draw a dot\n    context.lineTo(this.positionPoint.x + 1, this.positionPoint.y + 1);\n\n    // Normal fastest free hand drawing\n    // this.linePositions.forEach((linePosition) => {\n    //     context.lineTo(linePosition.x, linePosition.y);\n    // });\n\n    // Quadratic curves drawing\n    let i = 0;\n    while (i < this.linePositions.length) {\n      if (this.linePositions.length - i > 2) {\n        const controlPoint1 = this.linePositions[i];\n        const controlPoint2 = this.linePositions[i + 1];\n        const endPoint = this.linePositions[i + 2];\n        context.bezierCurveTo(controlPoint1.x,\n          controlPoint1.y,\n          controlPoint2.x,\n          controlPoint2.y,\n          endPoint.x,\n          endPoint.y);\n        i += 2;\n      } else {\n        const linePosition = this.linePositions[i];\n        context.lineTo(linePosition.x, linePosition.y);\n        i += 1;\n      }\n    }\n\n    context.stroke();\n  }\n\n  drawPreview(context: CanvasRenderingContext2D): void {\n    this.positionPoint = new CanvasWhiteboardPoint(2, 2);\n    this.linePositions = [\n      new CanvasWhiteboardPoint(context.canvas.width - 5, context.canvas.height * 0.3),\n      // new CanvasWhiteboardPoint(context.canvas.width * 0.4, context.canvas.height * 0.6),\n      new CanvasWhiteboardPoint(context.canvas.width * 0.2, context.canvas.height * 0.4),\n      new CanvasWhiteboardPoint(context.canvas.width * 0.6, context.canvas.height * 0.8),\n      new CanvasWhiteboardPoint(context.canvas.width, context.canvas.height)\n    ];\n\n    this.draw(context);\n  }\n\n  onUpdateReceived(update: CanvasWhiteboardUpdate): void {\n    this.linePositions.push(new CanvasWhiteboardPoint(update.x, update.y));\n  }\n}\n","import { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport class SmileyShape extends CanvasWhiteboardShape {\n  radius: number;\n\n  constructor(positionPoint?: CanvasWhiteboardPoint, options?: CanvasWhiteboardShapeOptions, radius?: number) {\n    super(positionPoint, options);\n    this.options.shouldFillShape = true;\n    this.options.fillStyle = this.options.fillStyle || 'yellow';\n\n    this.radius = radius || 0;\n  }\n\n  getShapeName(): string {\n    return 'SmileyShape';\n  }\n\n  draw(context: CanvasRenderingContext2D): void {\n    context.beginPath();\n\n    Object.assign(context, this.options);\n\n    context.arc(this.positionPoint.x, this.positionPoint.y, this.radius, 0, Math.PI * 2, false);\n    context.fill();\n    context.stroke();\n\n    context.beginPath();\n    const leftEyeX = this.positionPoint.x - this.radius * 0.3;\n    const rightEyeX = this.positionPoint.x + this.radius * 0.3;\n    const eyesY = this.positionPoint.y - this.radius * 0.2;\n    const eyeSize = this.radius * 0.1;\n\n    context.arc(leftEyeX, eyesY, eyeSize, 0, 2 * Math.PI, false);\n    context.arc(rightEyeX, eyesY, eyeSize, 0, 2 * Math.PI, false);\n    context.fillStyle = this.options.strokeStyle;\n    context.fill();\n\n    // draw the mouth\n    context.beginPath();\n    context.arc(this.positionPoint.x, this.positionPoint.y, this.radius * 0.7, 0, Math.PI, false);\n    context.stroke();\n\n    context.closePath();\n  }\n\n  drawPreview(context: CanvasRenderingContext2D): void {\n    this.positionPoint = new CanvasWhiteboardPoint(context.canvas.width / 2, context.canvas.height / 2);\n    this.radius = this.calculateRadius(context.canvas.width - 2, context.canvas.height / 2);\n    this.draw(context);\n  }\n\n  onUpdateReceived(update: CanvasWhiteboardUpdate): void {\n    this.radius = this.calculateRadius(update.x, update.y);\n  }\n\n  calculateRadius(x: number, y: number): number {\n    return Math.sqrt(Math.pow(x - this.positionPoint.x, 2) + Math.pow(y - this.positionPoint.y, 2));\n  }\n}\n","import { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport class StarShape extends CanvasWhiteboardShape {\n  radius: number;\n  spikes: number;\n\n  constructor(positionPoint?: CanvasWhiteboardPoint,\n              options?: CanvasWhiteboardShapeOptions,\n              radius?: number,\n              spikes?: number) {\n    super(positionPoint, options);\n    this.radius = radius || 0;\n    this.spikes = spikes || 5;\n  }\n\n  getShapeName(): string {\n    return 'StarShape';\n  }\n\n  draw(context: CanvasRenderingContext2D): void {\n    Object.assign(context, this.options);\n\n    let rotation = Math.PI / 2 * 3;\n    let spikeX = this.positionPoint.x;\n    let spikeY = this.positionPoint.y;\n    const step = Math.PI / this.spikes;\n\n    context.beginPath();\n    context.moveTo(this.positionPoint.x, this.positionPoint.y - this.radius);\n\n    for (let i = 0; i < this.spikes; i++) {\n      spikeX = this.positionPoint.x + Math.cos(rotation) * this.radius;\n      spikeY = this.positionPoint.y + Math.sin(rotation) * this.radius;\n      context.lineTo(spikeX, spikeY);\n      rotation += step;\n\n      spikeX = this.positionPoint.x + Math.cos(rotation) * (this.radius * 0.4);\n      spikeY = this.positionPoint.y + Math.sin(rotation) * (this.radius * 0.4);\n      context.lineTo(spikeX, spikeY);\n      rotation += step;\n      context.stroke();\n    }\n\n    context.lineTo(this.positionPoint.x, this.positionPoint.y - this.radius);\n    context.closePath();\n\n    context.stroke();\n\n    if (this.options.shouldFillShape) {\n      context.fill();\n    }\n  }\n\n  drawPreview(context: CanvasRenderingContext2D): void {\n    this.positionPoint = new CanvasWhiteboardPoint(context.canvas.width / 2, context.canvas.height / 2);\n    this.radius = this.calculateRadius(context.canvas.width - 2, context.canvas.height / 2);\n    this.draw(context);\n  }\n\n  onUpdateReceived(update: CanvasWhiteboardUpdate): void {\n    this.radius = this.calculateRadius(update.x, update.y);\n  }\n\n  calculateRadius(x: number, y: number): number {\n    return Math.sqrt(Math.pow(x - this.positionPoint.x, 2) + Math.pow(y - this.positionPoint.y, 2));\n  }\n}\n","import { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardUpdate } from '../canvas-whiteboard-update.model';\n\nexport class LineShape extends CanvasWhiteboardShape {\n  endPosition: CanvasWhiteboardPoint;\n\n  constructor(positionPoint?: CanvasWhiteboardPoint,\n              options?: CanvasWhiteboardShapeOptions,\n              endPosition?: CanvasWhiteboardPoint) {\n    super(positionPoint, options);\n    this.endPosition = endPosition || new CanvasWhiteboardPoint(this.positionPoint.x, this.positionPoint.y);\n  }\n\n  getShapeName(): string {\n    return 'LineShape';\n  }\n\n  draw(context: CanvasRenderingContext2D): void {\n    if (!this.endPosition) {\n      return;\n    }\n    context.beginPath();\n    Object.assign(context, this.options);\n\n    context.moveTo(this.positionPoint.x, this.positionPoint.y);\n    context.lineTo(this.endPosition.x, this.endPosition.y);\n\n    context.closePath();\n    context.stroke();\n  }\n\n  drawPreview(context: CanvasRenderingContext2D): void {\n    this.positionPoint = new CanvasWhiteboardPoint(0, 0);\n    this.endPosition = new CanvasWhiteboardPoint(context.canvas.width, context.canvas.height);\n    this.draw(context);\n  }\n\n  onUpdateReceived(update: CanvasWhiteboardUpdate): void {\n    this.endPosition = new CanvasWhiteboardPoint(update.x, update.y);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CircleShape } from './circle-shape';\nimport { RectangleShape } from './rectangle-shape';\nimport { FreeHandShape } from './free-hand-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { SmileyShape } from './smiley-shape';\nimport { StarShape } from './star-shape';\nimport { LineShape } from './line-shape';\nimport { BehaviorSubject, Observable } from 'rxjs';\n\nexport type INewCanvasWhiteboardShape<T extends CanvasWhiteboardShape> =\n  new(positionPoint?: CanvasWhiteboardPoint, options?: CanvasWhiteboardShapeOptions, ...args: any[]) => T;\n\n@Injectable()\nexport class CanvasWhiteboardShapeService {\n  private registeredShapesSubject: BehaviorSubject<Array<INewCanvasWhiteboardShape<CanvasWhiteboardShape>>>;\n  public registeredShapes$: Observable<Array<INewCanvasWhiteboardShape<CanvasWhiteboardShape>>>;\n\n  constructor() {\n    this.registeredShapesSubject = new BehaviorSubject([\n      FreeHandShape,\n      LineShape,\n      RectangleShape,\n      CircleShape,\n      StarShape,\n      SmileyShape\n    ]);\n    this.registeredShapes$ = this.registeredShapesSubject.asObservable();\n  }\n\n  getShapeConstructorFromShapeName(shapeName: string): INewCanvasWhiteboardShape<CanvasWhiteboardShape> {\n    return this.getCurrentRegisteredShapes().find((shape) =>\n      (new shape).getShapeName() === shapeName);\n  }\n\n  getCurrentRegisteredShapes(): Array<INewCanvasWhiteboardShape<CanvasWhiteboardShape>> {\n    return this.registeredShapesSubject.getValue();\n  }\n\n  isRegisteredShape(shape: INewCanvasWhiteboardShape<CanvasWhiteboardShape>): boolean {\n    return this.getCurrentRegisteredShapes().indexOf(shape) !== -1;\n  }\n\n  registerShape(shape: INewCanvasWhiteboardShape<CanvasWhiteboardShape>): void {\n    if (this.isRegisteredShape(shape)) {\n      console.warn(`You tried to register a shape:${shape}, but is has already been registered.`);\n      return;\n    }\n\n    const registeredShapes = this.getCurrentRegisteredShapes();\n    registeredShapes.push(shape);\n    this.registeredShapesSubject.next(registeredShapes);\n  }\n\n  registerShapes(shapes: Array<INewCanvasWhiteboardShape<CanvasWhiteboardShape>>): void {\n    this.registeredShapesSubject.next(\n      this.getCurrentRegisteredShapes()\n        .concat(\n          shapes.filter((shape) => {\n            if (this.isRegisteredShape(shape)) {\n              console.warn(`You tried to register a shape:${shape}, but is has already been registered.`);\n              return false;\n            }\n\n            return true;\n          })\n        )\n    );\n  }\n\n  unregisterShape(shape: INewCanvasWhiteboardShape<CanvasWhiteboardShape>): void {\n    this.registeredShapesSubject.next(\n      this.getCurrentRegisteredShapes().filter(registeredShape => registeredShape !== shape)\n    );\n  }\n\n  unregisterShapes(shapes: Array<INewCanvasWhiteboardShape<CanvasWhiteboardShape>>): void {\n    this.registeredShapesSubject.next(\n      this.getCurrentRegisteredShapes().filter(shape => shapes.indexOf(shape) === -1)\n    );\n  }\n}\n","import {\n  Component,\n  Output,\n  EventEmitter, OnInit, ViewChild, ElementRef, Input\n} from '@angular/core';\n\n@Component({\n  selector: 'canvas-whiteboard-colorpicker',\n  host: {\n    '(document:mousedown)': 'closeOnExternalClick($event)',\n    '(document:touchstart)': 'closeOnExternalClick($event)'\n  },\n  template: `\n    <div [hidden]=\"showColorPicker\" class=\"canvas-whiteboard-colorpicker-input\"\n         (click)=\"toggleColorPicker($event)\">\n      <div class=\"selected-color-type-wrapper\">{{previewText}}</div>\n      <div class=\"selected-color-preview\" [style.background]=\"selectedColor\"></div>\n    </div>\n    <div [hidden]=\"!showColorPicker\" class=\"canvas-whiteboard-colorpicker-wrapper\">\n      <div (click)=\"selectColor('transparent')\" class=\"transparent-color\">Transparent</div>\n      <canvas #canvaswhiteboardcolorpicker class=\"canvas-whiteboard-colorpicker\" width=\"284\" height=\"155\"\n              (click)=\"selectColor(determineColorFromCanvas($event))\"></canvas>\n    </div>\n  `,\n  styles: [`\n    .selected-color-preview {\n      width: 100%;\n      height: 20%;\n      position: absolute;\n      bottom: 0;\n      left: 0;\n    }\n\n    .selected-color-type-wrapper {\n      display: inline-block;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n      font-size: 14px;\n      color: #000;\n    }\n\n    .transparent-color {\n      font-size: 14px;\n    }\n\n    .canvas-whiteboard-colorpicker-wrapper {\n      border: 1px solid #afafaf;\n      color: #000;\n    }\n\n    @media (min-width: 401px) {\n      .canvas-whiteboard-colorpicker-wrapper {\n        position: absolute;\n      }\n    }\n\n    .canvas-whiteboard-colorpicker-input {\n      display: inline-block;\n      position: relative;\n      width: 44px;\n      height: 44px;\n      margin: 5px;\n      cursor: pointer;\n      color: #000;\n    }\n  `]\n})\nexport class CanvasWhiteboardColorPickerComponent implements OnInit {\n\n  @Input() previewText: string;\n  @Input() readonly selectedColor: string = 'rgba(0,0,0,1)';\n  @ViewChild('canvaswhiteboardcolorpicker', {static: true}) canvas: ElementRef;\n\n  @Input() readonly showColorPicker: boolean = false;\n  private _context: CanvasRenderingContext2D;\n\n  @Output() onToggleColorPicker = new EventEmitter<boolean>();\n  @Output() onColorSelected = new EventEmitter<string>();\n  @Output() onSecondaryColorSelected = new EventEmitter<string>();\n\n  constructor(private elementRef: ElementRef) {\n  }\n\n  /**\n   * Initialize the canvas drawing context. If we have an aspect ratio set up, the canvas will resize\n   * according to the aspect ratio.\n   */\n  ngOnInit(): void {\n    this._context = this.canvas.nativeElement.getContext('2d');\n    this.createColorPalette();\n  }\n\n  createColorPalette(): void {\n    let gradient = this._context.createLinearGradient(0, 0, this._context.canvas.width, 0);\n    gradient.addColorStop(0, 'rgb(255, 0, 0)');\n    gradient.addColorStop(0.15, 'rgb(255, 0, 255)');\n    gradient.addColorStop(0.33, 'rgb(0, 0, 255)');\n    gradient.addColorStop(0.49, 'rgb(0, 255, 255)');\n    gradient.addColorStop(0.67, 'rgb(0, 255, 0)');\n    gradient.addColorStop(0.84, 'rgb(255, 255, 0)');\n    gradient.addColorStop(1, 'rgb(255, 0, 0)');\n    this._context.fillStyle = gradient;\n    this._context.fillRect(0, 0, this._context.canvas.width, this._context.canvas.height);\n\n    gradient = this._context.createLinearGradient(0, 0, 0, this._context.canvas.height);\n    gradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\n    gradient.addColorStop(0.5, 'rgba(255, 255, 255, 0)');\n    gradient.addColorStop(0.5, 'rgba(0, 0, 0, 0)');\n    gradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\n    this._context.fillStyle = gradient;\n    this._context.fillRect(0, 0, this._context.canvas.width, this._context.canvas.height);\n  }\n\n  closeOnExternalClick(event): void {\n    if (!this.elementRef.nativeElement.contains(event.target) && this.showColorPicker) {\n      this.onToggleColorPicker.emit(false);\n    }\n  }\n\n  toggleColorPicker(event: Event): void {\n    if (event) {\n      event.preventDefault();\n    }\n\n    this.onToggleColorPicker.emit(!this.showColorPicker);\n  }\n\n  determineColorFromCanvas(event: any): string {\n    const canvasRect = this._context.canvas.getBoundingClientRect();\n    const imageData = this._context.getImageData(event.clientX - canvasRect.left,\n      event.clientY - canvasRect.top, 1, 1);\n\n    return `rgba(${imageData.data[0]}, ${imageData.data[1]}, ${imageData.data[2]}, ${imageData.data[3]})`;\n  }\n\n  selectColor(color: string): void {\n    this.onColorSelected.emit(color);\n    this.toggleColorPicker(null);\n  }\n}\n","import {\n  Component,\n  ElementRef,\n  Input,\n  ViewChild,\n  AfterViewInit,\n  OnChanges,\n  SimpleChanges\n} from '@angular/core';\nimport { INewCanvasWhiteboardShape } from './canvas-whiteboard-shape.service';\nimport { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardPoint } from '../canvas-whiteboard-point.model';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\n\n@Component({\n  selector: 'canvas-whiteboard-shape-preview',\n  template: `\n    <canvas #canvasWhiteboardShapePreview width=\"50px\" height=\"50px\"\n            class=\"canvas-whiteboard-shape-preview-canvas\"></canvas>\n  `,\n  styles: [`\n    .canvas-whiteboard-shape-preview-canvas {\n      cursor: pointer;\n    }\n  `]\n})\nexport class CanvasWhiteboardShapePreviewComponent implements AfterViewInit, OnChanges {\n  @Input() readonly shapeConstructor: INewCanvasWhiteboardShape<CanvasWhiteboardShape>;\n  @Input() readonly shapeOptions: CanvasWhiteboardShapeOptions;\n\n  @ViewChild('canvasWhiteboardShapePreview') canvas: ElementRef;\n\n  ngAfterViewInit(): void {\n    this.drawShapePreview();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.shapeConstructor || changes.shapeOptions) {\n      this.drawShapePreview();\n    }\n  }\n\n  drawShapePreview(): void {\n    if (!this.canvas) {\n      return;\n    }\n\n    const context: CanvasRenderingContext2D = this.canvas.nativeElement.getContext('2d');\n    context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n\n    const concreteShape = new this.shapeConstructor(\n      new CanvasWhiteboardPoint(0, 0),\n      Object.assign(new CanvasWhiteboardShapeOptions(), this.shapeOptions)\n    );\n\n    concreteShape.drawPreview(context);\n  }\n}\n","import {\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  Output\n} from '@angular/core';\nimport { CanvasWhiteboardShapeService, INewCanvasWhiteboardShape } from './canvas-whiteboard-shape.service';\nimport { CanvasWhiteboardShape } from './canvas-whiteboard-shape';\nimport { CanvasWhiteboardShapeOptions } from './canvas-whiteboard-shape-options';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'canvas-whiteboard-shape-selector',\n  host: {\n    '(document:mousedown)': 'closeOnExternalClick($event)',\n    '(document:touchstart)': 'closeOnExternalClick($event)'\n  },\n  template: `\n    <div *ngIf=\"!showShapeSelector\" (click)=\"toggleShapeSelector($event)\"\n         class=\"canvas-whiteboard-shape-selector-selected-preview\">\n      <canvas-whiteboard-shape-preview [shapeConstructor]=\"selectedShapeConstructor\"\n                                       [shapeOptions]=\"shapeOptions\"></canvas-whiteboard-shape-preview>\n    </div>\n    <div class=\"canvas-whiteboard-shape-selector-wrapper\" *ngIf=\"showShapeSelector\">\n      <canvas-whiteboard-shape-preview *ngFor=\"let shapeConstructor of registeredShapes$ | async\"\n                                       [shapeConstructor]=\"shapeConstructor\"\n                                       [shapeOptions]=\"shapeOptions\"\n                                       (click)=\"selectShape(shapeConstructor)\"></canvas-whiteboard-shape-preview>\n    </div>\n  `,\n  styles: [`\n    .canvas-whiteboard-shape-selector-selected-preview {\n      vertical-align: bottom;\n      display: inline-block;\n    }\n\n    .canvas-whiteboard-shape-selector-wrapper {\n      display: block;\n      padding: 4px;\n      border: 1px solid #afafaf;\n    }\n\n    @media (min-width: 401px) {\n      .canvas-whiteboard-shape-selector-wrapper {\n      }\n    }\n  `]\n})\nexport class CanvasWhiteboardShapeSelectorComponent {\n  @Input() readonly showShapeSelector: boolean = false;\n  @Input() readonly selectedShapeConstructor: INewCanvasWhiteboardShape<CanvasWhiteboardShape>;\n  @Input() readonly shapeOptions: CanvasWhiteboardShapeOptions;\n\n  @Output() onToggleShapeSelector = new EventEmitter<boolean>();\n  @Output() onShapeSelected = new EventEmitter<INewCanvasWhiteboardShape<CanvasWhiteboardShape>>();\n\n  registeredShapes$: Observable<INewCanvasWhiteboardShape<CanvasWhiteboardShape>[]>;\n\n  constructor(private elementRef: ElementRef,\n              private canvasWhiteboardShapeService: CanvasWhiteboardShapeService) {\n    this.registeredShapes$ = this.canvasWhiteboardShapeService.registeredShapes$;\n  }\n\n  selectShape(shape: INewCanvasWhiteboardShape<CanvasWhiteboardShape>): void {\n    this.onShapeSelected.emit(shape);\n    this.toggleShapeSelector(null);\n  }\n\n  closeOnExternalClick(event): void {\n    if (!this.elementRef.nativeElement.contains(event.target) && this.showShapeSelector) {\n      this.onToggleShapeSelector.emit(false);\n    }\n  }\n\n  toggleShapeSelector(event: Event): void {\n    if (event) {\n      event.preventDefault();\n    }\n\n    this.onToggleShapeSelector.emit(!this.showShapeSelector);\n  }\n}\n","import {\n  Component,\n  Input,\n  Output,\n  EventEmitter,\n  ViewChild,\n  ElementRef,\n  OnInit,\n  OnChanges, OnDestroy, AfterViewInit, NgZone, ChangeDetectorRef\n} from '@angular/core';\nimport { CanvasWhiteboardUpdate, CanvasWhiteboardUpdateType } from './canvas-whiteboard-update.model';\nimport { DEFAULT_STYLES } from './template';\nimport { CanvasWhiteboardService } from './canvas-whiteboard.service';\nimport { CanvasWhiteboardOptions } from './canvas-whiteboard-options';\nimport { CanvasWhiteboardShape } from './shapes/canvas-whiteboard-shape';\nimport { CanvasWhiteboardPoint } from './canvas-whiteboard-point.model';\nimport { CanvasWhiteboardShapeService, INewCanvasWhiteboardShape } from './shapes/canvas-whiteboard-shape.service';\nimport { CanvasWhiteboardShapeOptions } from './shapes/canvas-whiteboard-shape-options';\nimport { fromEvent, Subscription } from 'rxjs';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { cloneDeep, isEqual } from 'lodash-es';\n\n@Component({\n  selector: 'canvas-whiteboard',\n  template:\n    `\n    <div class=\"canvas_wrapper_div\">\n      <div class=\"canvas_whiteboard_buttons\">\n        <canvas-whiteboard-shape-selector *ngIf=\"shapeSelectorEnabled\"\n                                          [showShapeSelector]=\"showShapeSelector\"\n                                          [selectedShapeConstructor]=\"selectedShapeConstructor\"\n                                          [shapeOptions]=\"generateShapePreviewOptions()\"\n                                          (onToggleShapeSelector)=\"toggleShapeSelector($event)\"\n                                          (onShapeSelected)=\"selectShape($event)\"></canvas-whiteboard-shape-selector>\n\n        <canvas-whiteboard-colorpicker *ngIf=\"colorPickerEnabled || fillColorPickerEnabled\"\n                                       [previewText]=\"fillColorPickerText\"\n                                       [showColorPicker]=\"showFillColorPicker\"\n                                       [selectedColor]=\"fillColor\"\n                                       (onToggleColorPicker)=\"toggleFillColorPicker($event)\"\n                                       (onColorSelected)=\"changeFillColor($event)\">\n        </canvas-whiteboard-colorpicker>\n\n        <canvas-whiteboard-colorpicker *ngIf=\"colorPickerEnabled || strokeColorPickerEnabled\"\n                                       [previewText]=\"strokeColorPickerText\"\n                                       [showColorPicker]=\"showStrokeColorPicker\"\n                                       [selectedColor]=\"strokeColor\"\n                                       (onToggleColorPicker)=\"toggleStrokeColorPicker($event)\"\n                                       (onColorSelected)=\"changeStrokeColor($event)\">\n        </canvas-whiteboard-colorpicker>\n\n\n        <button *ngIf=\"drawButtonEnabled\" (click)=\"toggleDrawingEnabled()\"\n                [class.canvas_whiteboard_button-draw_animated]=\"getDrawingEnabled()\"\n                class=\"canvas_whiteboard_button canvas_whiteboard_button-draw\" type=\"button\">\n          <i [class]=\"drawButtonClass\" aria-hidden=\"true\"></i> {{drawButtonText}}\n        </button>\n\n        <button *ngIf=\"clearButtonEnabled\" (click)=\"clearCanvasLocal()\" type=\"button\"\n                class=\"canvas_whiteboard_button canvas_whiteboard_button-clear\">\n          <i [class]=\"clearButtonClass\" aria-hidden=\"true\"></i> {{clearButtonText}}\n        </button>\n\n        <button *ngIf=\"undoButtonEnabled\" (click)=\"undoLocal()\" type=\"button\"\n                class=\"canvas_whiteboard_button canvas_whiteboard_button-undo\">\n          <i [class]=\"undoButtonClass\" aria-hidden=\"true\"></i> {{undoButtonText}}\n        </button>\n\n        <button *ngIf=\"redoButtonEnabled\" (click)=\"redoLocal()\" type=\"button\"\n                class=\"canvas_whiteboard_button canvas_whiteboard_button-redo\">\n          <i [class]=\"redoButtonClass\" aria-hidden=\"true\"></i> {{redoButtonText}}\n        </button>\n        <button *ngIf=\"saveDataButtonEnabled\" (click)=\"saveLocal()\" type=\"button\"\n                class=\"canvas_whiteboard_button canvas_whiteboard_button-save\">\n          <i [class]=\"saveDataButtonClass\" aria-hidden=\"true\"></i> {{saveDataButtonText}}\n        </button>\n      </div>\n      <canvas #canvas class=\"canvas_whiteboard\"></canvas>\n      <canvas #incompleteShapesCanvas class=\"incomplete_shapes_canvas_whiteboard\"\n              (mousedown)=\"canvasUserEvents($event)\" (mouseup)=\"canvasUserEvents($event)\"\n              (mousemove)=\"canvasUserEvents($event)\" (mouseout)=\"canvasUserEvents($event)\"\n              (touchstart)=\"canvasUserEvents($event)\" (touchmove)=\"canvasUserEvents($event)\"\n              (touchend)=\"canvasUserEvents($event)\" (touchcancel)=\"canvasUserEvents($event)\"></canvas>\n    </div>\n  `,\n  styles: [DEFAULT_STYLES]\n})\nexport class CanvasWhiteboardComponent implements OnInit, AfterViewInit, OnChanges, OnDestroy {\n  @Input() options: CanvasWhiteboardOptions;\n\n  // Number of ms to wait before sending out the updates as an array\n  @Input() batchUpdateTimeoutDuration = 100;\n\n  private _imageUrl: string;\n  @Input() set imageUrl(imageUrl: string) {\n    this._imageUrl = imageUrl;\n    this._imageElement = null;\n    this._redrawHistory();\n  }\n\n  get imageUrl(): string {\n    return this._imageUrl;\n  }\n\n  @Input() aspectRatio: number;\n  @Input() drawButtonClass: string;\n  @Input() clearButtonClass: string;\n  @Input() undoButtonClass: string;\n  @Input() redoButtonClass: string;\n  @Input() saveDataButtonClass: string;\n  @Input() drawButtonText = '';\n  @Input() clearButtonText = '';\n  @Input() undoButtonText = '';\n  @Input() redoButtonText = '';\n  @Input() saveDataButtonText = '';\n  @Input() strokeColorPickerText = 'Stroke';\n  @Input() fillColorPickerText = 'Fill';\n  @Input() drawButtonEnabled = true;\n  @Input() clearButtonEnabled = true;\n  @Input() undoButtonEnabled = false;\n  @Input() redoButtonEnabled = false;\n  @Input() saveDataButtonEnabled = false;\n  @Input() shouldDownloadDrawing = true;\n  /** @deprecated. Replaced with strokeColorPickerEnabled and fillColorPickerEnabled inputs */\n  @Input() colorPickerEnabled: boolean = false;\n  @Input() strokeColorPickerEnabled: boolean = false;\n  @Input() fillColorPickerEnabled: boolean = false;\n  @Input() lineWidth = 2;\n  @Input() strokeColor = 'rgba(0, 0, 0, 1)';\n  @Input() startingColor = '#fff';\n  @Input() scaleFactor = 0;\n  @Input() drawingEnabled = false;\n  @Input() showStrokeColorPicker = false;\n  @Input() showFillColorPicker = false;\n  @Input() downloadedFileName: string;\n\n  @Input() lineJoin = 'round';\n  @Input() lineCap = 'round';\n  @Input() shapeSelectorEnabled = true;\n  @Input() showShapeSelector = false;\n  @Input() fillColor = 'rgba(0,0,0,0)';\n\n  @Output() onClear = new EventEmitter<any>();\n  @Output() onUndo = new EventEmitter<any>();\n  @Output() onRedo = new EventEmitter<any>();\n  @Output() onBatchUpdate = new EventEmitter<CanvasWhiteboardUpdate[]>();\n  @Output() onImageLoaded = new EventEmitter<any>();\n  @Output() onSave = new EventEmitter<string | Blob>();\n\n  @ViewChild('canvas', { static: true }) canvas: ElementRef;\n  context: CanvasRenderingContext2D;\n\n  @ViewChild('incompleteShapesCanvas', { static: true }) private _incompleteShapesCanvas: ElementRef;\n  private _incompleteShapesCanvasContext: CanvasRenderingContext2D;\n  private _incompleteShapesMap: Map<string, CanvasWhiteboardShape>;\n\n  private _imageElement: any;\n\n  private _canDraw = true;\n\n  private _clientDragging = false;\n\n  private _updateHistory: CanvasWhiteboardUpdate[] = [];\n  private _lastUUID: string;\n  private _shapesMap: Map<string, CanvasWhiteboardShape>;\n\n  private _undoStack: string[] = []; // Stores the value of start and count for each continuous stroke\n  private _redoStack: string[] = [];\n  private _batchUpdates: CanvasWhiteboardUpdate[] = [];\n  private _updatesNotDrawn: any = [];\n\n  private _updateTimeout: any;\n\n  private _canvasWhiteboardServiceSubscriptions: Subscription[] = [];\n  private _resizeSubscription: Subscription;\n  private _registeredShapesSubscription: Subscription;\n\n  selectedShapeConstructor: INewCanvasWhiteboardShape<CanvasWhiteboardShape>;\n  canvasWhiteboardShapePreviewOptions: CanvasWhiteboardShapeOptions;\n\n  constructor(private ngZone: NgZone,\n    private changeDetectorRef: ChangeDetectorRef,\n    private canvasWhiteboardService: CanvasWhiteboardService,\n    private canvasWhiteboardShapeService: CanvasWhiteboardShapeService) {\n    this._shapesMap = new Map<string, CanvasWhiteboardShape>();\n    this._incompleteShapesMap = new Map<string, CanvasWhiteboardShape>();\n    this.canvasWhiteboardShapePreviewOptions = this.generateShapePreviewOptions();\n  }\n\n  /**\n   * Initialize the canvas drawing context. If we have an aspect ratio set up, the canvas will resize\n   * according to the aspect ratio.\n   */\n  ngOnInit(): void {\n    this._initInputsFromOptions(this.options);\n    this._initCanvasEventListeners();\n    this._initCanvasServiceObservables();\n    this.context = this.canvas.nativeElement.getContext('2d');\n    this._incompleteShapesCanvasContext = this._incompleteShapesCanvas.nativeElement.getContext('2d');\n  }\n\n  /**\n   * If an image exists and it's url changes, we need to redraw the new image on the canvas.\n   */\n  ngOnChanges(changes: any): void {\n    if (changes.options && !isEqual(changes.options.currentValue, changes.options.previousValue)) {\n      this._initInputsFromOptions(changes.options.currentValue);\n    }\n  }\n\n  /**\n   * Recalculate the width and height of the canvas after the view has been fully initialized\n   */\n  ngAfterViewInit(): void {\n    this._calculateCanvasWidthAndHeight();\n    this._redrawHistory();\n  }\n\n  /**\n   * This method reads the options which are helpful since they can be really long when specified in HTML\n   * This method is also called everytime the options object changes\n   * For security reasons we must check each item on its own since if we iterate the keys\n   * we may be injected with malicious values\n   *\n   * @param options\n   */\n  private _initInputsFromOptions(options: CanvasWhiteboardOptions): void {\n    if (options) {\n      if (!this._isNullOrUndefined(options.batchUpdateTimeoutDuration)) {\n        this.batchUpdateTimeoutDuration = options.batchUpdateTimeoutDuration;\n      }\n      if (!this._isNullOrUndefined(options.imageUrl)) {\n        this.imageUrl = options.imageUrl;\n      }\n      if (!this._isNullOrUndefined(options.aspectRatio)) {\n        this.aspectRatio = options.aspectRatio;\n      }\n      if (!this._isNullOrUndefined(options.drawButtonClass)) {\n        this.drawButtonClass = options.drawButtonClass;\n      }\n      if (!this._isNullOrUndefined(options.clearButtonClass)) {\n        this.clearButtonClass = options.clearButtonClass;\n      }\n      if (!this._isNullOrUndefined(options.undoButtonClass)) {\n        this.undoButtonClass = options.undoButtonClass;\n      }\n      if (!this._isNullOrUndefined(options.redoButtonClass)) {\n        this.redoButtonClass = options.redoButtonClass;\n      }\n      if (!this._isNullOrUndefined(options.saveDataButtonClass)) {\n        this.saveDataButtonClass = options.saveDataButtonClass;\n      }\n      if (!this._isNullOrUndefined(options.drawButtonText)) {\n        this.drawButtonText = options.drawButtonText;\n      }\n      if (!this._isNullOrUndefined(options.clearButtonText)) {\n        this.clearButtonText = options.clearButtonText;\n      }\n      if (!this._isNullOrUndefined(options.undoButtonText)) {\n        this.undoButtonText = options.undoButtonText;\n      }\n      if (!this._isNullOrUndefined(options.redoButtonText)) {\n        this.redoButtonText = options.redoButtonText;\n      }\n      if (!this._isNullOrUndefined(options.saveDataButtonText)) {\n        this.saveDataButtonText = options.saveDataButtonText;\n      }\n      if (!this._isNullOrUndefined(options.strokeColorPickerText)) {\n        this.strokeColorPickerText = options.strokeColorPickerText;\n      }\n      if (!this._isNullOrUndefined(options.fillColorPickerText)) {\n        this.fillColorPickerText = options.fillColorPickerText;\n      }\n      if (!this._isNullOrUndefined(options.drawButtonEnabled)) {\n        this.drawButtonEnabled = options.drawButtonEnabled;\n      }\n      if (!this._isNullOrUndefined(options.clearButtonEnabled)) {\n        this.clearButtonEnabled = options.clearButtonEnabled;\n      }\n      if (!this._isNullOrUndefined(options.undoButtonEnabled)) {\n        this.undoButtonEnabled = options.undoButtonEnabled;\n      }\n      if (!this._isNullOrUndefined(options.redoButtonEnabled)) {\n        this.redoButtonEnabled = options.redoButtonEnabled;\n      }\n      if (!this._isNullOrUndefined(options.saveDataButtonEnabled)) {\n        this.saveDataButtonEnabled = options.saveDataButtonEnabled;\n      }\n      if (!this._isNullOrUndefined(options.colorPickerEnabled)) {\n        this.colorPickerEnabled = options.colorPickerEnabled;\n      }\n      if (!this._isNullOrUndefined(options.strokeColorPickerEnabled)) {\n        this.strokeColorPickerEnabled = options.strokeColorPickerEnabled;\n      }\n      if (!this._isNullOrUndefined(options.fillColorPickerEnabled)) {\n        this.fillColorPickerEnabled = options.fillColorPickerEnabled;\n      }\n      if (!this._isNullOrUndefined(options.lineWidth)) {\n        this.lineWidth = options.lineWidth;\n      }\n      if (!this._isNullOrUndefined(options.strokeColor)) {\n        this.strokeColor = options.strokeColor;\n      }\n      if (!this._isNullOrUndefined(options.shouldDownloadDrawing)) {\n        this.shouldDownloadDrawing = options.shouldDownloadDrawing;\n      }\n      if (!this._isNullOrUndefined(options.startingColor)) {\n        this.startingColor = options.startingColor;\n      }\n      if (!this._isNullOrUndefined(options.scaleFactor)) {\n        this.scaleFactor = options.scaleFactor;\n      }\n      if (!this._isNullOrUndefined(options.drawingEnabled)) {\n        this.drawingEnabled = options.drawingEnabled;\n      }\n      if (!this._isNullOrUndefined(options.downloadedFileName)) {\n        this.downloadedFileName = options.downloadedFileName;\n      }\n      if (!this._isNullOrUndefined(options.lineJoin)) {\n        this.lineJoin = options.lineJoin;\n      }\n      if (!this._isNullOrUndefined(options.lineCap)) {\n        this.lineCap = options.lineCap;\n      }\n      if (!this._isNullOrUndefined(options.shapeSelectorEnabled)) {\n        this.shapeSelectorEnabled = options.shapeSelectorEnabled;\n      }\n      if (!this._isNullOrUndefined(options.showShapeSelector)) {\n        this.showShapeSelector = options.showShapeSelector;\n      }\n      if (!this._isNullOrUndefined(options.fillColor)) {\n        this.fillColor = options.fillColor;\n      }\n      if (!this._isNullOrUndefined(options.showStrokeColorPicker)) {\n        this.showStrokeColorPicker = options.showStrokeColorPicker;\n      }\n      if (!this._isNullOrUndefined(options.showFillColorPicker)) {\n        this.showFillColorPicker = options.showFillColorPicker;\n      }\n    }\n  }\n\n  private _isNullOrUndefined(property: any): boolean {\n    return property === null || property === undefined;\n  }\n\n  /**\n   * Init global window listeners like resize and keydown\n   */\n  private _initCanvasEventListeners(): void {\n    this.ngZone.runOutsideAngular(() => {\n      this._resizeSubscription = fromEvent(window, 'resize')\n        .pipe(\n          debounceTime(200),\n          distinctUntilChanged()\n        )\n        .subscribe(() => {\n          this.ngZone.run(() => {\n            this._redrawCanvasOnResize();\n          });\n        });\n    });\n\n    window.addEventListener('keydown', this._canvasKeyDown.bind(this), false);\n  }\n\n  /**\n   * Subscribes to new signals in the canvas whiteboard service and executes methods accordingly\n   * Because of circular publishing and subscribing, the canvas methods do not use the service when\n   * local actions are completed (Ex. clicking undo from the button inside this component)\n   */\n  private _initCanvasServiceObservables(): void {\n    this._canvasWhiteboardServiceSubscriptions.push(this.canvasWhiteboardService.canvasDrawSubject$\n      .subscribe(updates => this.drawUpdates(updates)));\n    this._canvasWhiteboardServiceSubscriptions.push(this.canvasWhiteboardService.canvasClearSubject$\n      .subscribe(() => this.clearCanvas()));\n    this._canvasWhiteboardServiceSubscriptions.push(this.canvasWhiteboardService.canvasUndoSubject$\n      .subscribe((updateUUD) => this._undoCanvas(updateUUD)));\n    this._canvasWhiteboardServiceSubscriptions.push(this.canvasWhiteboardService.canvasRedoSubject$\n      .subscribe((updateUUD) => this._redoCanvas(updateUUD)));\n\n    this._registeredShapesSubscription = this.canvasWhiteboardShapeService.registeredShapes$.subscribe((shapes) => {\n      if (!this.selectedShapeConstructor || !this.canvasWhiteboardShapeService.isRegisteredShape(this.selectedShapeConstructor)) {\n        this.selectedShapeConstructor = shapes[0];\n      }\n    });\n  }\n\n  /**\n   * Calculate the canvas width and height from it's parent container width and height (use aspect ratio if needed)\n   */\n  private _calculateCanvasWidthAndHeight(): void {\n    this.context.canvas.width = this.canvas.nativeElement.parentNode.clientWidth;\n    if (this.aspectRatio) {\n      this.context.canvas.height = this.canvas.nativeElement.parentNode.clientWidth * this.aspectRatio;\n    } else {\n      this.context.canvas.height = this.canvas.nativeElement.parentNode.clientHeight;\n    }\n\n    this._incompleteShapesCanvasContext.canvas.width = this.context.canvas.width;\n    this._incompleteShapesCanvasContext.canvas.height = this.context.canvas.height;\n  }\n\n  /**\n   * Load an image and draw it on the canvas (if an image exists)\n   * @param callbackFn A function that is called after the image loading is finished\n   * @return Emits a value when the image has been loaded.\n   */\n  private _loadImage(callbackFn?: any): void {\n    this._canDraw = false;\n\n    // If we already have the image there is no need to acquire it\n    if (this._imageElement) {\n      this._canDraw = true;\n      callbackFn && callbackFn();\n      return;\n    }\n\n    this._imageElement = new Image();\n    this._imageElement.addEventListener('load', () => {\n      this._canDraw = true;\n      callbackFn && callbackFn();\n      this.onImageLoaded.emit(true);\n    });\n    this._imageElement.src = this.imageUrl;\n  }\n\n  /**\n   * Sends a notification after clearing the canvas\n   * This method should only be called from the clear button in this component since it will emit an clear event\n   * If the client calls this method he may create a circular clear action which may cause danger.\n   */\n  clearCanvasLocal(): void {\n    this.clearCanvas();\n    this.onClear.emit(true);\n  }\n\n  /**\n   * Clears all content on the canvas.\n   */\n  clearCanvas(): void {\n    this._removeCanvasData();\n    this._redoStack = [];\n  }\n\n  /**\n   * This method resets the state of the canvas and redraws it.\n   * It calls a callback function after redrawing\n   * @param callbackFn\n   */\n  private _removeCanvasData(callbackFn?: any): void {\n    this._shapesMap = new Map<string, CanvasWhiteboardShape>();\n    this._clientDragging = false;\n    this._updateHistory = [];\n    this._undoStack = [];\n    this._redrawBackground(callbackFn);\n  }\n\n  /**\n   * Clears the canvas and redraws the image if the url exists.\n   * @param callbackFn A function that is called after the background is redrawn\n   * @return Emits a value when the clearing is finished\n   */\n  private _redrawBackground(callbackFn?: any): void {\n    if (this.context) {\n      if (this.imageUrl) {\n        this._loadImage(() => {\n          this.context.save();\n          this._drawImage(this.context, this._imageElement, 0, 0, this.context.canvas.width, this.context.canvas.height, 0.5, 0.5);\n          this.context.restore();\n          this._drawMissingUpdates();\n          callbackFn && callbackFn();\n        });\n      } else {\n        this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\n        this._drawStartingColor();\n        callbackFn && callbackFn();\n      }\n    }\n  }\n\n  private _drawStartingColor(): void {\n    const previousFillStyle = this.context.fillStyle;\n    this.context.save();\n\n    this.context.fillStyle = this.startingColor;\n    this.context.fillRect(0, 0, this.context.canvas.width, this.context.canvas.height);\n    this.context.fillStyle = previousFillStyle;\n\n    this.context.restore();\n  }\n\n\n  /**\n   * @deprecated Use getDrawingEnabled(): boolean\n   */\n  getShouldDraw(): boolean {\n    return this.getDrawingEnabled();\n  }\n\n  /**\n   * Returns a value of whether the user clicked the draw button on the canvas.\n   */\n  getDrawingEnabled(): boolean {\n    return this.drawingEnabled;\n  }\n\n  /**\n   * Toggles drawing on the canvas. It is called via the draw button on the canvas.\n   */\n  toggleDrawingEnabled(): void {\n    this.drawingEnabled = !this.drawingEnabled;\n  }\n\n  /**\n   * Set if drawing is enabled from the client using the canvas\n   * @param drawingEnabled\n   */\n  setDrawingEnabled(drawingEnabled: boolean): void {\n    this.drawingEnabled = drawingEnabled;\n  }\n\n  /**\n   * @deprecated Please use the changeStrokeColor(newStrokeColor: string): void method\n   */\n  changeColor(newStrokeColor: string): void {\n    this.changeStrokeColor(newStrokeColor);\n  }\n\n  /**\n   * Replaces the drawing color with a new color\n   * The format should be (\"#ffffff\" or \"rgb(r,g,b,a?)\")\n   * This method is public so that anyone can access the canvas and change the stroke color\n   *\n   * @param newStrokeColor The new stroke color\n   */\n  changeStrokeColor(newStrokeColor: string): void {\n    this.strokeColor = newStrokeColor;\n\n    this.canvasWhiteboardShapePreviewOptions = this.generateShapePreviewOptions();\n    this.changeDetectorRef.detectChanges();\n  }\n\n  /**\n   * Replaces the fill color with a new color\n   * The format should be (\"#ffffff\" or \"rgb(r,g,b,a?)\")\n   * This method is public so that anyone can access the canvas and change the fill color\n   *\n   * @param newFillColor The new fill color\n   */\n  changeFillColor(newFillColor: string): void {\n    this.fillColor = newFillColor;\n    this.canvasWhiteboardShapePreviewOptions = this.generateShapePreviewOptions();\n    this.changeDetectorRef.detectChanges();\n  }\n\n  /**\n   * This method is invoked by the undo button on the canvas screen\n   * It calls the global undo method and emits a notification after undoing.\n   * This method should only be called from the undo button in this component since it will emit an undo event\n   * If the client calls this method he may create a circular undo action which may cause danger.\n   */\n  undoLocal(): void {\n    this.undo((updateUUID) => {\n      this._redoStack.push(updateUUID);\n      this.onUndo.emit(updateUUID);\n    });\n  }\n\n  /**\n   * This methods selects the last uuid prepares it for undoing (making the whole update sequence invisible)\n   * This method can be called if the canvas component is a ViewChild of some other component.\n   * This method will work even if the undo button has been disabled\n   */\n  undo(callbackFn?: (updateUUID: string) => void): void {\n    if (!this._undoStack.length) {\n      return;\n    }\n\n    const updateUUID = this._undoStack.pop();\n    this._undoCanvas(updateUUID);\n    callbackFn && callbackFn(updateUUID);\n  }\n\n  /**\n   * This method takes an UUID for an update, and redraws the canvas by making all updates with that uuid invisible\n   * @param updateUUID\n   */\n  private _undoCanvas(updateUUID: string): void {\n    if (this._shapesMap.has(updateUUID)) {\n      const shape = this._shapesMap.get(updateUUID);\n      shape.isVisible = false;\n      this.drawAllShapes();\n    }\n  }\n\n  /**\n   * This method is invoked by the redo button on the canvas screen\n   * It calls the global redo method and emits a notification after redoing\n   * This method should only be called from the redo button in this component since it will emit an redo event\n   * If the client calls this method he may create a circular redo action which may cause danger.\n   */\n  redoLocal(): void {\n    this.redo((updateUUID) => {\n      this._undoStack.push(updateUUID);\n      this.onRedo.emit(updateUUID);\n    });\n  }\n\n  /**\n   * This methods selects the last uuid prepares it for redoing (making the whole update sequence visible)\n   * This method can be called if the canvas component is a ViewChild of some other component.\n   * This method will work even if the redo button has been disabled\n   */\n  redo(callbackFn?: any): void {\n    if (!this._redoStack.length) {\n      return;\n    }\n\n    const updateUUID = this._redoStack.pop();\n    this._redoCanvas(updateUUID);\n    callbackFn && callbackFn(updateUUID);\n  }\n\n  /**\n   * This method takes an UUID for an update, and redraws the canvas by making all updates with that uuid visible\n   * @param updateUUID\n   */\n  private _redoCanvas(updateUUID: string): void {\n    if (this._shapesMap.has(updateUUID)) {\n      const shape = this._shapesMap.get(updateUUID);\n      shape.isVisible = true;\n\n      this.drawAllShapes();\n    }\n  }\n\n  /**\n   * Catches the Mouse and Touch events made on the canvas.\n   * If drawing is disabled (If an image exists but it's not loaded, or the user did not click Draw),\n   * this function does nothing.\n   *\n   * If a \"mousedown | touchstart\" event is triggered, dragging will be set to true and an CanvasWhiteboardUpdate object\n   * of type \"start\" will be drawn and then sent as an update to all receiving ends.\n   *\n   * If a \"mousemove | touchmove\" event is triggered and the client is dragging, an CanvasWhiteboardUpdate object\n   * of type \"drag\" will be drawn and then sent as an update to all receiving ends.\n   *\n   * If a \"mouseup, mouseout | touchend, touchcancel\" event is triggered, dragging will be set to false and\n   * an CanvasWhiteboardUpdate object of type \"stop\" will be drawn and then sent as an update to all receiving ends.\n   *\n   */\n  canvasUserEvents(event: any): void {\n    // Ignore all if we didn't click the _draw! button or the image did not load\n    if (!this.drawingEnabled || !this._canDraw) {\n      return;\n    }\n\n    // Ignore mouse move Events if we're not dragging\n    if (!this._clientDragging\n      && (event.type === 'mousemove'\n        || event.type === 'touchmove'\n        || event.type === 'mouseout'\n        || event.type === 'touchcancel'\n        || event.type === 'mouseup'\n        || event.type === 'touchend'\n        || event.type === 'mouseout')) {\n      return;\n    }\n\n    if (event.target == this._incompleteShapesCanvas.nativeElement || event.target == this.canvas.nativeElement) {\n      event.preventDefault();\n    }\n\n    let update: CanvasWhiteboardUpdate;\n    let updateType: number;\n    const eventPosition: CanvasWhiteboardPoint = this._getCanvasEventPosition(event);\n    update = new CanvasWhiteboardUpdate(eventPosition.x, eventPosition.y);\n\n    switch (event.type) {\n      case 'mousedown':\n      case 'touchstart':\n        this._clientDragging = true;\n        this._lastUUID = this._generateUUID();\n        updateType = CanvasWhiteboardUpdateType.START;\n        this._redoStack = [];\n\n        this._addCurrentShapeDataToAnUpdate(update);\n        break;\n      case 'mousemove':\n      case 'touchmove':\n        if (!this._clientDragging) {\n          return;\n        }\n        updateType = CanvasWhiteboardUpdateType.DRAG;\n        break;\n      case 'touchcancel':\n      case 'mouseup':\n      case 'touchend':\n      case 'mouseout':\n        this._clientDragging = false;\n        updateType = CanvasWhiteboardUpdateType.STOP;\n        this._undoStack.push(this._lastUUID);\n        break;\n    }\n\n    update.UUID = this._lastUUID;\n    update.type = updateType;\n\n    this._draw(update);\n    this._prepareToSendUpdate(update);\n  }\n\n  /**\n   * Get the coordinates (x,y) from a given event\n   * If it is a touch event, get the touch positions\n   * If we released the touch, the position will be placed in the changedTouches object\n   * If it is not a touch event, use the original mouse event received\n   * @param eventData\n   */\n  private _getCanvasEventPosition(eventData: any): CanvasWhiteboardPoint {\n    const canvasBoundingRect = this.context.canvas.getBoundingClientRect();\n\n    let hasTouches = (eventData.touches && eventData.touches.length) ? eventData.touches[0] : null;\n    if (!hasTouches) {\n      hasTouches = (eventData.changedTouches && eventData.changedTouches.length) ? eventData.changedTouches[0] : null;\n    }\n\n    const event = hasTouches ? hasTouches : eventData;\n\n    const scaleWidth = canvasBoundingRect.width / this.context.canvas.width;\n    const scaleHeight = canvasBoundingRect.height / this.context.canvas.height;\n\n    let xPosition = (event.clientX - canvasBoundingRect.left);\n    let yPosition = (event.clientY - canvasBoundingRect.top);\n\n    xPosition /= this.scaleFactor ? this.scaleFactor : scaleWidth;\n    yPosition /= this.scaleFactor ? this.scaleFactor : scaleHeight;\n\n    return new CanvasWhiteboardPoint(xPosition / this.context.canvas.width, yPosition / this.context.canvas.height);\n  }\n\n  /**\n   * The update coordinates on the canvas are mapped so that all receiving ends\n   * can reverse the mapping and get the same position as the one that\n   * was drawn on this update.\n   *\n   * @param update The CanvasWhiteboardUpdate object.\n   */\n  private _prepareToSendUpdate(update: CanvasWhiteboardUpdate): void {\n    this._prepareUpdateForBatchDispatch(update);\n  }\n\n\n  /**\n   * Catches the Key Up events made on the canvas.\n   * If the ctrlKey or commandKey(macOS) was held and the keyCode is 90 (z), an undo action will be performed\n   * If the ctrlKey or commandKey(macOS) was held and the keyCode is 89 (y), a redo action will be performed\n   * If the ctrlKey or commandKey(macOS) was held and the keyCode is 83 (s) or 115(S), a save action will be performed\n   *\n   * @param event The event that occurred.\n   */\n  private _canvasKeyDown(event: any): void {\n    if (event.ctrlKey || event.metaKey) {\n      if (event.keyCode === 90 && this.undoButtonEnabled) {\n        event.preventDefault();\n        this.undo();\n      }\n      if (event.keyCode === 89 && this.redoButtonEnabled) {\n        event.preventDefault();\n        this.redo();\n      }\n      if (event.keyCode === 83 || event.keyCode === 115) {\n        event.preventDefault();\n        this.saveLocal();\n      }\n    }\n  }\n\n  /**\n   * On window resize, recalculate the canvas dimensions and redraw the history\n   */\n  private _redrawCanvasOnResize(): void {\n    this._calculateCanvasWidthAndHeight();\n    this._redrawHistory();\n  }\n\n  /**\n   * Redraw the saved history after resetting the canvas state\n   */\n  private _redrawHistory(): void {\n    const updatesToDraw = [].concat(this._updateHistory);\n\n    this._removeCanvasData(() => {\n      updatesToDraw.forEach((update: CanvasWhiteboardUpdate) => {\n        this._draw(update);\n      });\n    });\n  }\n\n  /**\n   * Draws a CanvasWhiteboardUpdate object on the canvas.\n   * The coordinates are first reverse mapped so that they can be drawn in the proper place. The update\n   * is afterwards added to the undoStack so that it can be\n   *\n   * If the CanvasWhiteboardUpdate Type is \"start\", a new \"selectedShape\" is created.\n   * If the CanvasWhiteboardUpdate Type is \"drag\", the shape is taken from the shapesMap and then it's updated.\n   * Afterwards the context is used to draw the shape on the canvas.\n   * This function saves the last X and Y coordinates that were drawn.\n   *\n   * @param update The update object.\n   */\n  private _draw(update: CanvasWhiteboardUpdate): void {\n    this._updateHistory.push(update);\n\n    // map the canvas coordinates to our canvas size since they are scaled.\n    update = Object.assign(new CanvasWhiteboardUpdate(),\n      update,\n      {\n        x: update.x * this.context.canvas.width,\n        y: update.y * this.context.canvas.height\n      });\n\n    if (update.type === CanvasWhiteboardUpdateType.START) {\n      const updateShapeConstructor = this.canvasWhiteboardShapeService.getShapeConstructorFromShapeName(update.selectedShape);\n      const shape = new updateShapeConstructor(\n        new CanvasWhiteboardPoint(update.x, update.y),\n        Object.assign(new CanvasWhiteboardShapeOptions(), update.selectedShapeOptions)\n      );\n      this._incompleteShapesMap.set(update.UUID, shape);\n      this._drawIncompleteShapes();\n    } else if (update.type === CanvasWhiteboardUpdateType.DRAG) {\n      const shape = this._incompleteShapesMap.get(update.UUID);\n      shape && shape.onUpdateReceived(update);\n      this._drawIncompleteShapes();\n    } else if (CanvasWhiteboardUpdateType.STOP) {\n      const shape = this._incompleteShapesMap.get(update.UUID);\n      shape && shape.onStopReceived(update);\n\n      this._shapesMap.set(update.UUID, shape);\n      this._incompleteShapesMap.delete(update.UUID);\n      this._swapCompletedShapeToActualCanvas(shape);\n    }\n  }\n\n  private _drawIncompleteShapes(): void {\n    this._resetIncompleteShapeCanvas();\n    this._incompleteShapesMap.forEach((shape) => {\n      if (shape.isVisible) {\n        shape.draw(this._incompleteShapesCanvasContext);\n      }\n    });\n  }\n\n  private _swapCompletedShapeToActualCanvas(shape: CanvasWhiteboardShape): void {\n    this._drawIncompleteShapes();\n    if (shape.isVisible) {\n      shape.draw(this.context);\n    }\n  }\n\n  private _resetIncompleteShapeCanvas(): void {\n    this._incompleteShapesCanvasContext.clearRect(0, 0, this._incompleteShapesCanvasContext.canvas.width,\n      this._incompleteShapesCanvasContext.canvas.height);\n    this._incompleteShapesCanvasContext.fillStyle = 'transparent';\n    this._incompleteShapesCanvasContext.fillRect(0, 0, this._incompleteShapesCanvasContext.canvas.width,\n      this._incompleteShapesCanvasContext.canvas.height);\n  }\n\n  /**\n   * Delete everything from the screen, redraw the background, and then redraw all the shapes from the shapesMap\n   */\n  drawAllShapes(): void {\n    this._redrawBackground(() => {\n      this._shapesMap.forEach((shape: CanvasWhiteboardShape) => {\n        if (shape.isVisible) {\n          shape.draw(this.context);\n        }\n      });\n    });\n  }\n\n  private _addCurrentShapeDataToAnUpdate(update: CanvasWhiteboardUpdate): void {\n    if (!update.selectedShape) {\n      update.selectedShape = (new this.selectedShapeConstructor).getShapeName();\n    }\n\n    if (!update.selectedShapeOptions) {\n      // Make a deep copy since we don't want some Shape implementation to change something by accident\n      update.selectedShapeOptions = Object.assign(new CanvasWhiteboardShapeOptions(),\n        this.generateShapePreviewOptions(), { lineWidth: this.lineWidth });\n    }\n  }\n\n  generateShapePreviewOptions(): CanvasWhiteboardShapeOptions {\n    return Object.assign(new CanvasWhiteboardShapeOptions(),\n      {\n        shouldFillShape: !!this.fillColor,\n        fillStyle: this.fillColor,\n        strokeStyle: this.strokeColor,\n        lineWidth: 2,\n        lineJoin: this.lineJoin,\n        lineCap: this.lineCap\n      });\n  }\n\n  /**\n   * Sends the update to all receiving ends as an Event emit. This is done as a batch operation (meaning\n   * multiple updates are sent at the same time). If this method is called, after 100 ms all updates\n   * that were made at that time will be packed up together and sent to the receiver.\n   *\n   * @param update The update object.\n   * @return Emits an Array of Updates when the batch.\n   */\n  private _prepareUpdateForBatchDispatch(update: CanvasWhiteboardUpdate): void {\n    this._batchUpdates.push(cloneDeep(update));\n    if (!this._updateTimeout) {\n      this._updateTimeout = setTimeout(() => {\n        this.onBatchUpdate.emit(this._batchUpdates);\n        this._batchUpdates = [];\n        this._updateTimeout = null;\n      }, this.batchUpdateTimeoutDuration);\n    }\n  }\n\n  /**\n   * Draws an Array of Updates on the canvas.\n   *\n   * @param updates The array with Updates.\n   */\n  drawUpdates(updates: CanvasWhiteboardUpdate[]): void {\n    if (this._canDraw) {\n      this._drawMissingUpdates();\n      updates.forEach((update: CanvasWhiteboardUpdate) => {\n        this._draw(update);\n      });\n    } else {\n      this._updatesNotDrawn = this._updatesNotDrawn.concat(updates);\n    }\n  }\n\n  /**\n   * Draw any missing updates that were received before the image was loaded\n   */\n  private _drawMissingUpdates(): void {\n    if (this._updatesNotDrawn.length > 0) {\n      const updatesToDraw = this._updatesNotDrawn;\n      this._updatesNotDrawn = [];\n\n      updatesToDraw.forEach((update: CanvasWhiteboardUpdate) => {\n        this._draw(update);\n      });\n    }\n  }\n\n  /**\n   * Draws an image on the canvas\n   *\n   * @param context The context used to draw the image on the canvas.\n   * @param image The image to draw.\n   * @param x The X coordinate for the starting draw position.\n   * @param y The Y coordinate for the starting draw position.\n   * @param width The width of the image that will be drawn.\n   * @param height The height of the image that will be drawn.\n   * @param offsetX The offsetX if the image size is larger than the canvas (aspect Ratio)\n   * @param offsetY The offsetY if the image size is larger than the canvas (aspect Ratio)\n   */\n  private _drawImage(context: any, image: any, x: number, y: number, width: number, height: number, offsetX: number, offsetY: number): void {\n    if (arguments.length === 2) {\n      x = y = 0;\n      width = context.canvas.width;\n      height = context.canvas.height;\n    }\n\n    offsetX = typeof offsetX === 'number' ? offsetX : 0.5;\n    offsetY = typeof offsetY === 'number' ? offsetY : 0.5;\n\n    if (offsetX < 0) {\n      offsetX = 0;\n    }\n    if (offsetY < 0) {\n      offsetY = 0;\n    }\n    if (offsetX > 1) {\n      offsetX = 1;\n    }\n    if (offsetY > 1) {\n      offsetY = 1;\n    }\n\n    const imageWidth = image.width;\n    const imageHeight = image.height;\n    const radius = Math.min(width / imageWidth, height / imageHeight);\n    let newWidth = imageWidth * radius;\n    let newHeight = imageHeight * radius;\n    let finalDrawX: any;\n    let finalDrawY: any;\n    let finalDrawWidth: any;\n    let finalDrawHeight: any;\n    let aspectRatio = 1;\n\n    // decide which gap to fill\n    if (newWidth < width) {\n      aspectRatio = width / newWidth;\n    }\n    if (Math.abs(aspectRatio - 1) < 1e-14 && newHeight < height) {\n      aspectRatio = height / newHeight;\n    }\n    newWidth *= aspectRatio;\n    newHeight *= aspectRatio;\n\n    // calculate source rectangle\n    finalDrawWidth = imageWidth / (newWidth / width);\n    finalDrawHeight = imageHeight / (newHeight / height);\n\n    finalDrawX = (imageWidth - finalDrawWidth) * offsetX;\n    finalDrawY = (imageHeight - finalDrawHeight) * offsetY;\n\n    // make sure the source rectangle is valid\n    if (finalDrawX < 0) {\n      finalDrawX = 0;\n    }\n    if (finalDrawY < 0) {\n      finalDrawY = 0;\n    }\n    if (finalDrawWidth > imageWidth) {\n      finalDrawWidth = imageWidth;\n    }\n    if (finalDrawHeight > imageHeight) {\n      finalDrawHeight = imageHeight;\n    }\n\n    // fill the image in destination rectangle\n    context.drawImage(image, finalDrawX, finalDrawY, finalDrawWidth, finalDrawHeight, x, y, width, height);\n  }\n\n  /**\n   * The HTMLCanvasElement.toDataURL() method returns a data URI containing a representation of the image in the format specified by the type parameter (defaults to PNG).\n   * The returned image is in a resolution of 96 dpi.\n   * If the height or width of the canvas is 0, the string \"data:,\" is returned.\n   * If the requested type is not image/png, but the returned value starts with data:image/png, then the requested type is not supported.\n   * Chrome also supports the image/webp type.\n   *\n   * @param returnedDataType A DOMString indicating the image format. The default format type is image/png.\n   * @param returnedDataQuality A Number between 0 and 1 indicating image quality if the requested type is image/jpeg or image/webp.\n   If this argument is anything else, the default value for image quality is used. The default value is 0.92. Other arguments are ignored.\n   */\n  generateCanvasDataUrl(returnedDataType: string = 'image/png', returnedDataQuality: number = 1): string {\n    return this.context.canvas.toDataURL(returnedDataType, returnedDataQuality);\n  }\n\n  /**\n   * Generate a Blob object representing the content drawn on the canvas.\n   * This file may be cached on the disk or stored in memory at the discretion of the user agent.\n   * If type is not specified, the image type is image/png. The created image is in a resolution of 96dpi.\n   * The third argument is used with image/jpeg images to specify the quality of the output.\n   *\n   * @param callbackFn The function that should be executed when the blob is created. Should accept a parameter Blob (for the result).\n   * @param returnedDataType A DOMString indicating the image format. The default type is image/png.\n   * @param returnedDataQuality A Number between 0 and 1 indicating image quality if the requested type is image/jpeg or image/webp.\n   If this argument is anything else, the default value for image quality is used. Other arguments are ignored.\n   */\n  generateCanvasBlob(callbackFn: any, returnedDataType: string = 'image/png', returnedDataQuality: number = 1): void {\n    let toBlobMethod: Function;\n\n    if (typeof this.context.canvas.toBlob !== 'undefined') {\n      toBlobMethod = this.context.canvas.toBlob.bind(this.context.canvas);\n    } else if (typeof (this.context.canvas as any).msToBlob !== 'undefined') {\n      // For IE\n      toBlobMethod = (callback) => {\n        callback && callback((this.context.canvas as any).msToBlob());\n      };\n    }\n\n    toBlobMethod && toBlobMethod((blob: Blob) => {\n      callbackFn && callbackFn(blob, returnedDataType);\n    }, returnedDataType, returnedDataQuality);\n  }\n\n  /**\n   * Generate a canvas image representation and download it locally\n   * The name of the image is canvas_drawing_ + the current local Date and Time the image was created\n   * Methods for standalone creation of the images in this method are left here for backwards compatibility\n   *\n   * @param returnedDataType A DOMString indicating the image format. The default type is image/png.\n   * @param downloadData? The created string or Blob (IE).\n   * @param customFileName? The name of the file that should be downloaded\n   */\n  downloadCanvasImage(returnedDataType: string = 'image/png', downloadData?: string | Blob, customFileName?: string): void {\n    // @ts-ignore\n    if (window.navigator.msSaveOrOpenBlob === undefined) {\n      const downloadLink = document.createElement('a');\n      downloadLink.setAttribute('href', downloadData ? downloadData as string : this.generateCanvasDataUrl(returnedDataType));\n\n      const fileName = customFileName ? customFileName\n        : (this.downloadedFileName ? this.downloadedFileName : 'canvas_drawing_' + new Date().valueOf());\n\n      downloadLink.setAttribute('download', fileName + this._generateDataTypeString(returnedDataType));\n      document.body.appendChild(downloadLink);\n      downloadLink.click();\n      document.body.removeChild(downloadLink);\n    } else {\n      // IE-specific code\n      if (downloadData) {\n        this._saveCanvasBlob(downloadData as Blob, returnedDataType);\n      } else {\n        this.generateCanvasBlob(this._saveCanvasBlob.bind(this), returnedDataType);\n      }\n    }\n  }\n\n  /**\n   * Save the canvas blob (IE) locally\n   * @param blob\n   * @param returnedDataType\n   */\n  private _saveCanvasBlob(blob: Blob, returnedDataType: string = 'image/png'): void {\n    // @ts-ignore\n    window.navigator.msSaveOrOpenBlob(blob, 'canvas_drawing_' +\n      new Date().valueOf() + this._generateDataTypeString(returnedDataType));\n  }\n\n  /**\n   * This method generates a canvas url string or a canvas blob with the presented data type\n   * A callback function is then invoked since the blob creation must be done via a callback\n   *\n   * @param callback\n   * @param returnedDataType\n   * @param returnedDataQuality\n   */\n  generateCanvasData(callback: any, returnedDataType: string = 'image/png', returnedDataQuality: number = 1): void {\n    // @ts-ignore\n    if (window.navigator.msSaveOrOpenBlob === undefined) {\n      callback && callback(this.generateCanvasDataUrl(returnedDataType, returnedDataQuality));\n    } else {\n      this.generateCanvasBlob(callback, returnedDataType, returnedDataQuality);\n    }\n  }\n\n  /**\n   * Local method to invoke saving of the canvas data when clicked on the canvas Save button\n   * This method will emit the generated data with the specified Event Emitter\n   *\n   * @param returnedDataType\n   */\n  saveLocal(returnedDataType: string = 'image/png'): void {\n    this.generateCanvasData((generatedData: string | Blob) => {\n      this.onSave.emit(generatedData);\n\n      if (this.shouldDownloadDrawing) {\n        this.downloadCanvasImage(returnedDataType, generatedData);\n      }\n    });\n  }\n\n  private _generateDataTypeString(returnedDataType: string): string {\n    if (returnedDataType) {\n      return '.' + returnedDataType.split('/')[1];\n    }\n\n    return '';\n  }\n\n  /**\n   * Toggles the color picker window, delegating the showColorPicker Input to the ColorPickerComponent.\n   * If no value is supplied (null/undefined) the current value will be negated and used.\n   * @param value\n   */\n  toggleStrokeColorPicker(value: boolean): void {\n    this.showStrokeColorPicker = !this._isNullOrUndefined(value) ? value : !this.showStrokeColorPicker;\n  }\n\n  /**\n   * Toggles the color picker window, delegating the showColorPicker Input to the ColorPickerComponent.\n   * If no value is supplied (null/undefined) the current value will be negated and used.\n   * @param value\n   */\n  toggleFillColorPicker(value: boolean): void {\n    this.showFillColorPicker = !this._isNullOrUndefined(value) ? value : !this.showFillColorPicker;\n  }\n\n  /**\n   * Toggles the shape selector window, delegating the showShapeSelector Input to the CanvasWhiteboardShapeSelectorComponent.\n   * If no value is supplied (null/undefined) the current value will be negated and used.\n   * @param value\n   */\n  toggleShapeSelector(value: boolean): void {\n    this.showShapeSelector = !this._isNullOrUndefined(value) ? value : !this.showShapeSelector;\n  }\n\n  selectShape(newShapeBlueprint: INewCanvasWhiteboardShape<CanvasWhiteboardShape>): void {\n    this.selectedShapeConstructor = newShapeBlueprint;\n  }\n\n  /**\n   * Returns a deep copy of the current drawing history for the canvas.\n   * The deep copy is returned because we don't want anyone to mutate the current history\n   */\n  getDrawingHistory(): CanvasWhiteboardUpdate[] {\n    return cloneDeep(this._updateHistory);\n  }\n\n  /**\n   * Unsubscribe from a given subscription if it is active\n   * @param subscription\n   */\n  private _unsubscribe(subscription: Subscription): void {\n    if (subscription) {\n      subscription.unsubscribe();\n    }\n  }\n\n  private _generateUUID(): string {\n    return this._random4() + this._random4() + '-' + this._random4() + '-' + this._random4() + '-' +\n      this._random4() + '-' + this._random4() + this._random4() + this._random4();\n  }\n\n  private _random4(): string {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  /**\n   * Unsubscribe from the service observables\n   */\n  ngOnDestroy(): void {\n    this._unsubscribe(this._resizeSubscription);\n    this._unsubscribe(this._registeredShapesSubscription);\n    this._canvasWhiteboardServiceSubscriptions.forEach(subscription => this._unsubscribe(subscription));\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CanvasWhiteboardComponent } from './canvas-whiteboard.component';\nimport { CommonModule } from '@angular/common';\nimport { CanvasWhiteboardColorPickerComponent } from './canvas-whiteboard-colorpicker.component';\nimport { CanvasWhiteboardShapeSelectorComponent } from './shapes/canvas-whiteboard-shape-selector.component';\nimport { CanvasWhiteboardShapePreviewComponent } from './shapes/canvas-whiteboard-shape-preview.component';\nimport { CanvasWhiteboardService } from './canvas-whiteboard.service';\nimport { CanvasWhiteboardShapeService } from './shapes/canvas-whiteboard-shape.service';\n\n@NgModule({\n  declarations: [\n    CanvasWhiteboardComponent,\n    CanvasWhiteboardColorPickerComponent,\n    CanvasWhiteboardShapeSelectorComponent,\n    CanvasWhiteboardShapePreviewComponent\n  ],\n  imports: [\n    CommonModule\n  ],\n  providers: [\n    CanvasWhiteboardService,\n    CanvasWhiteboardShapeService\n  ],\n  exports: [CanvasWhiteboardComponent]\n})\nexport class CanvasWhiteboardModule {\n\n}\n","/*\n * Public API Surface of ng2-canvas-whiteboard\n */\nexport { CanvasWhiteboardComponent } from './lib/canvas-whiteboard.component';\nexport { CanvasWhiteboardUpdate } from './lib/canvas-whiteboard-update.model';\nexport { CanvasWhiteboardService } from './lib/canvas-whiteboard.service';\nexport { CanvasWhiteboardOptions } from './lib/canvas-whiteboard-options';\nexport { CanvasWhiteboardPoint } from './lib/canvas-whiteboard-point.model';\nexport { CanvasWhiteboardShape } from './lib/shapes/canvas-whiteboard-shape';\nexport { CanvasWhiteboardShapeOptions } from './lib/shapes/canvas-whiteboard-shape-options';\nexport { CanvasWhiteboardShapeService } from './lib/shapes/canvas-whiteboard-shape.service';\nexport { FreeHandShape } from './lib/shapes/free-hand-shape';\nexport { CircleShape } from './lib/shapes/circle-shape';\nexport { LineShape } from './lib/shapes/line-shape';\nexport { RectangleShape } from './lib/shapes/rectangle-shape';\nexport { SmileyShape } from './lib/shapes/smiley-shape';\nexport { StarShape } from './lib/shapes/star-shape';\nexport { CanvasWhiteboardShapeSelectorComponent } from './lib/shapes/canvas-whiteboard-shape-selector.component';\nexport { CanvasWhiteboardColorPickerComponent } from './lib/canvas-whiteboard-colorpicker.component';\nexport { CanvasWhiteboardShapePreviewComponent } from './lib/shapes/canvas-whiteboard-shape-preview.component';\nexport { CanvasWhiteboardModule } from './lib/ng2-canvas-whiteboard.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.CanvasWhiteboardShapeService","i1.CanvasWhiteboardService","i2.CanvasWhiteboardShapeService"],"mappings":"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"}